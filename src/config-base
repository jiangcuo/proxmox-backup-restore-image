CONFIG_LOCALVERSION="-pbs-restore"

# kernel commandline override
CONFIG_CMDLINE_BOOL=y
CONFIG_CMDLINE="console=ttyS0"

# NOTE: ZFS will be enabled from Makefile, since we can only activate it after
# 'copy-builtin' creates the necessary Kconfig in the kernel tree.
# CONFIG_ZFS=y

# in case we crash the kernel, so we can at least read the stacktraces
CONFIG_KALLSYMS=y

# CPU settings
CONFIG_64BIT=y
CONFIG_MMU=y
CONFIG_SMP=y
CONFIG_X86_X2APIC=y
CONFIG_ACPI=y
# not super necessary, but avoids a warning
CONFIG_RETPOLINE=y

# basic kernel features
CONFIG_MULTIUSER=y
CONFIG_POSIX_TIMERS=y
CONFIG_BUG=y
CONFIG_FUTEX=y
CONFIG_EPOLL=y
CONFIG_AIO=y
CONFIG_BINFMT_ELF=y
CONFIG_ELFCORE=y
CONFIG_PRINTK=y
CONFIG_EVENTFD=y
CONFIG_MODULES=y

# initramfs support
CONFIG_TMPFS=y
CONFIG_BLK_DEV_INITRD=y

# paravirt acceleration
CONFIG_KVM_GUEST=y
CONFIG_PARAVIRT=y
CONFIG_PARAVIRT_CLOCK=y
CONFIG_PARAVIRT_SPINLOCKS=y
CONFIG_VIRTIO_MENU=y
CONFIG_VIRTIO=y

# enable terminal on serial for debugging/logging
CONFIG_TTY=y
CONFIG_VT=y
CONFIG_VT_CONSOLE=y
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y
CONFIG_INPUT_KEYBOARD=y

# vsock support
CONFIG_PCI=y
CONFIG_NET=y
CONFIG_UNIX=y
CONFIG_VSOCKETS=y
CONFIG_VIRTIO_VSOCKETS=y
CONFIG_VIRTIO_VSOCKETS_COMMON=y

# block device support, especially virtio-scsi/blk
CONFIG_BLOCK=y
CONFIG_BLK_DEV=y
CONFIG_BLK_DEV_SD=y
CONFIG_BLK_DEV_SR=y
CONFIG_VIRT_DRIVERS=y
CONFIG_SCSI=y
CONFIG_SCSI_VIRTIO=y
CONFIG_BLK_MQ_VIRTIO=y
CONFIG_VIRTIO_BLK=y
CONFIG_VIRTIO_MMIO=y
CONFIG_VIRTIO_PCI=y

# md/LVM/device-mapper support
CONFIG_DM_CRYPT=y
CONFIG_DM_MIRROR=y
CONFIG_DM_RAID=y
CONFIG_DM_SNAPSHOT=y
CONFIG_DM_THIN_PROVISIONING=y
CONFIG_DM_UNSTRIPED=y
CONFIG_MD=y
CONFIG_MD_AUTODETECT=y
CONFIG_MD_LINEAR=y
CONFIG_MD_RAID0=y
CONFIG_MD_RAID1=y
CONFIG_MD_RAID10=y
CONFIG_MD_RAID456=y
CONFIG_BLK_DEV_MD=y
CONFIG_BLK_DEV_DM=y

# basic fs features
CONFIG_FS_POSIX_ACL=y
CONFIG_DEVTMPFS=y
CONFIG_DEVTMPFS_MOUNT=y
CONFIG_PROC_FS=y
# proc_sysctl is necessary for ZFS, it panics otherwise
CONFIG_PROC_SYSCTL=y
CONFIG_SYSFS=y
CONFIG_NLS=y
CONFIG_NLS_UTF8=y
CONFIG_NLS_ISO8859_1=y
CONFIG_NLS_CODEPAGE_437=y
CONFIG_MSDOS_PARTITION=y
CONFIG_EFI_PARTITION=y
CONFIG_FILE_LOCKING=y

# filesystem support
CONFIG_MISC_FILESYSTEMS=y
CONFIG_EXT2_FS=y
CONFIG_EXT2_FS_XATTR=y
CONFIG_EXT2_FS_POSIX_ACL=y
CONFIG_EXT3_FS=y
CONFIG_EXT3_FS_XATTR=y
CONFIG_EXT3_FS_POSIX_ACL=y
CONFIG_EXT4_FS=y
CONFIG_EXT4_FS_XATTR=y
CONFIG_EXT4_FS_POSIX_ACL=y
CONFIG_REISERFS_FS=y
CONFIG_REISERFS_FS_XATTR=y
CONFIG_REISERFS_FS_POSIX_ACL=y
CONFIG_JFS_FS=y
CONFIG_JFS_POSIX_ACL=y
CONFIG_XFS_FS=y
CONFIG_XFS_POSIX_ACL=y
CONFIG_XFS_SUPPORT_V4=y
CONFIG_BTRFS_FS=y
CONFIG_BTRFS_FS_POSIX_ACL=y
CONFIG_F2FS_FS=y
CONFIG_F2FS_FS_XATTR=y
CONFIG_F2FS_FS_POSIX_ACL=y
CONFIG_F2FS_FS_COMPRESSION=y
CONFIG_F2FS_FS_LZO=y
CONFIG_F2FS_FS_LZ4=y
CONFIG_F2FS_FS_ZSTD=y
CONFIG_F2FS_FS_LZORLE=y
CONFIG_HFS_FS=y
CONFIG_HFSPLUS_FS=y
CONFIG_BEFS_FS=y
CONFIG_SYSV_FS=y
CONFIG_UFS_FS=y
CONFIG_ISO9660_FS=y
CONFIG_NTFS3_FS=y
CONFIG_MSDOS_FS=y
CONFIG_VFAT_FS=y

# memory hotplug
CONFIG_MEMORY_HOTPLUG=y
CONFIG_MEMORY_HOTPLUG_DEFAULT_ONLINE=y
CONFIG_MEMORY_HOTREMOVE=y
CONFIG_ACPI_HOTPLUG_MEMORY=y
